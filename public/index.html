<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Document Detective | Full Stack</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/9.1.2/marked.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --bg-dark: #0a0a0a; --bg-panel: #111111; --primary: #00d4ff;
            --text-main: #e0e0e0; --border: #333; --glass: rgba(255, 255, 255, 0.03);
        }
        body { background: var(--bg-dark); color: var(--text-main); font-family: sans-serif; display: flex; flex-direction: column; min-height: 100vh; margin: 0; }
        .hero { text-align: center; padding: 50px 20px; background: linear-gradient(to bottom, #1a1a2e, var(--bg-dark)); }
        .container { display: flex; flex: 1; border-top: 1px solid var(--border); }
        aside { width: 300px; background: var(--bg-panel); padding: 20px; border-right: 1px solid var(--border); }
        main { flex: 1; padding: 20px; display: flex; flex-direction: column; }
        .chat-box { flex: 1; background: var(--glass); border-radius: 8px; padding: 15px; overflow-y: auto; margin-bottom: 20px; border: 1px solid var(--border); }
        .contact-form { padding: 20px; background: var(--bg-panel); border: 1px solid var(--primary); border-radius: 10px; margin: 20px; }
        input, textarea { width: 100%; background: #000; color: #fff; border: 1px solid var(--border); padding: 10px; margin-bottom: 10px; border-radius: 4px; }
        .btn { background: var(--primary); color: #000; border: none; padding: 10px 20px; cursor: pointer; font-weight: bold; border-radius: 4px; }
    </style>
</head>
<body>

    <div class="hero">
        <h1 style="color: var(--primary); font-size: 2.5rem;">AI Document Detective</h1>
        <p>Analyze legal contracts with Gemini 1.5 Flash</p>
    </div>

    <div class="container">
        <aside>
            <h3><i class="fa-solid fa-folder"></i> Evidence Locker</h3>
            <input type="file" id="file-input" accept="application/pdf" style="font-size: 0.8rem;">
            <div id="file-status" style="font-size: 0.8rem; margin-top: 10px; color: var(--primary);"></div>
        </aside>

        <main>
            <div id="chat-container" class="chat-box">
                <strong>System:</strong> Ready. Upload a PDF to begin analysis.
            </div>
            <div style="display: flex; gap: 10px;">
                <textarea id="user-input" placeholder="Ask Gemini about the contract..."></textarea>
                <button class="btn" id="askBtn">Ask AI</button>
            </div>
        </main>
    </div>

    <div class="contact-form">
        <h3 style="color: var(--primary);">Message the Admin</h3>
        <input type="text" id="admin-name" placeholder="Your Name">
        <textarea id="admin-msg" placeholder="Your Feedback/Question"></textarea>
        <button id="sendBtn" class="btn">Send to Firebase</button>
        <p id="db-status" style="font-size: 0.8rem; margin-top: 5px;"></p>
    </div>

    <footer style="padding: 10px; text-align: center; font-size: 0.7rem; border-top: 1px solid var(--border);">
        Powered by Vertex AI & Firebase Hosting
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-app.js";
        import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-firestore.js";

        // --- 1. FIREBASE CONFIG ---
        const firebaseConfig = {
            apiKey: "AIzaSyBcTwpQZJoxT_2xJttcj6RCHatSUXV2y0s",
            authDomain: "gdg-crackathon-a7294.firebaseapp.com",
            projectId: "gdg-crackathon-a7294",
            storageBucket: "gdg-crackathon-a7294.firebasestorage.app",
            messagingSenderId: "752107073890",
            appId: "1:752107073890:web:0cdcff88737c266a6187c3b"
        };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // --- 2. ADMIN FORM LOGIC ---
        document.getElementById('sendBtn').onclick = async () => {
            const name = document.getElementById('admin-name').value;
            const msg = document.getElementById('admin-msg').value;
            try {
                await addDoc(collection(db, "messages"), { sender: name, content: msg, date: new Date() });
                document.getElementById('db-status').innerText = "Successfully saved to Firebase!";
            } catch (e) { document.getElementById('db-status').innerText = "Error: " + e.message; }
        };

        // --- 3. AI DETECTIVE LOGIC ---
        // (Simplified for this full-file example)
        document.getElementById('askBtn').onclick = () => {
            const chat = document.getElementById('chat-container');
            const input = document.getElementById('user-input');
            chat.innerHTML += `<br><strong>You:</strong> ${input.value}<br><strong>AI:</strong> Analyzing... (Connect Gemini Key in Settings to finish)`;
            input.value = "";
        };
    </script>
</body>
</html>